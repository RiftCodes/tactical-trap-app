"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3751],{3751:(se,b,r)=>{r.r(b),r.d(b,{HomePageModule:()=>ie});var m=r(177),c=r(7125),P=r(4341),v=r(70),l=r(467),C=r(5083);const M=(0,C.F3)("App",{web:()=>r.e(9303).then(r.bind(r,9303)).then(o=>new o.AppWeb)});var D=r(5312),F=r(1413),g=r(2352),k=r(3823);const I=(0,C.F3)("Browser",{web:()=>r.e(4786).then(r.bind(r,4786)).then(o=>new o.BrowserWeb)});var t=r(4438),O=r(3656);let S=(()=>{class o{constructor(){this.hidden=!1,this.digits=4,this.title="Enter PIN",this.pinValue=new t.bkB,this.pin="",(this.digits<2||this.digits>20)&&(this.digits=4)}handleInput(e){switch(e){case"del":this.pin.length>0&&(this.pin=this.pin.substr(0,this.pin.length-1));break;case"OK":this.pin.length>=this.digits&&(this.pinValue.emit(this.pin),this.pin="");break;case"cancel":this.pinValue.emit(null),this.pin="";break;default:this.pin.length<this.digits&&(this.pin+=e)}}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["ble-lock-keypad"]],inputs:{hidden:"hidden",digits:"digits",title:"title"},outputs:{pinValue:"pinValue"},decls:36,vars:3,consts:[[1,"keypad",3,"hidden"],[1,"title"],["fill","outline","size","small",3,"click"],["name","close"],[1,"pin"],[1,"row"],["shape","round","size","large","fill","outline",1,"equal",3,"click"],["shape","round","size","large","fill","outline",1,"rect",3,"click"],["name","backspace"]],template:function(i,n){1&i&&(t.j41(0,"div",0)(1,"div",1),t.EFF(2),t.j41(3,"ion-button",2),t.bIt("click",function(){return n.handleInput("cancel")}),t.nrm(4,"ion-icon",3),t.k0s()(),t.j41(5,"div",4)(6,"div"),t.EFF(7),t.k0s()(),t.j41(8,"div",5)(9,"ion-button",6),t.bIt("click",function(){return n.handleInput("1")}),t.EFF(10,"1"),t.k0s(),t.j41(11,"ion-button",6),t.bIt("click",function(){return n.handleInput("2")}),t.EFF(12,"2"),t.k0s(),t.j41(13,"ion-button",6),t.bIt("click",function(){return n.handleInput("3")}),t.EFF(14,"3"),t.k0s()(),t.j41(15,"div",5)(16,"ion-button",6),t.bIt("click",function(){return n.handleInput("4")}),t.EFF(17,"4"),t.k0s(),t.j41(18,"ion-button",6),t.bIt("click",function(){return n.handleInput("5")}),t.EFF(19,"5"),t.k0s(),t.j41(20,"ion-button",6),t.bIt("click",function(){return n.handleInput("6")}),t.EFF(21,"6"),t.k0s()(),t.j41(22,"div",5)(23,"ion-button",6),t.bIt("click",function(){return n.handleInput("7")}),t.EFF(24,"7"),t.k0s(),t.j41(25,"ion-button",6),t.bIt("click",function(){return n.handleInput("8")}),t.EFF(26,"8"),t.k0s(),t.j41(27,"ion-button",6),t.bIt("click",function(){return n.handleInput("9")}),t.EFF(28,"9"),t.k0s()(),t.j41(29,"div",5)(30,"ion-button",7),t.bIt("click",function(){return n.handleInput("del")}),t.nrm(31,"ion-icon",8),t.k0s(),t.j41(32,"ion-button",6),t.bIt("click",function(){return n.handleInput("0")}),t.EFF(33,"0"),t.k0s(),t.j41(34,"ion-button",7),t.bIt("click",function(){return n.handleInput("OK")}),t.EFF(35,"OK"),t.k0s()()()),2&i&&(t.Y8G("hidden",n.hidden),t.R7$(2),t.JRh(n.title),t.R7$(5),t.SpI("\xa0",n.pin,"\xa0"))},dependencies:[c.Jm,c.iq],styles:[".keypad[_ngcontent-%COMP%]{margin:0 auto;width:326px;border:2px solid gray;border-radius:20px;padding:5px 0 15px;background-color:#fff!important}.title[_ngcontent-%COMP%]{position:relative;padding:10px 10px 6px 0;font-size:1rem;text-align:center}.title[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{position:absolute;right:1em;margin-top:-1px}.pin[_ngcontent-%COMP%]{position:relative;padding:11px 0 15px}.pin[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{text-align:center;display:inline-block;background:#f8f8f8;border:1px solid #B8B8B8;margin:0 0 0 calc(50% - 4em);width:8em;height:2em;font-size:larger;padding:3px 0}.pin[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{position:absolute;right:1em}.equal[_ngcontent-%COMP%]{margin:14px 8px}.rect[_ngcontent-%COMP%]{margin:14px 0 0}@media only screen and (min-width: 380px){.title[_ngcontent-%COMP%]{font-size:1.3rem}}@media only screen and (min-width: 480px){.keypad[_ngcontent-%COMP%]{margin-top:5vh}.equal[_ngcontent-%COMP%]{margin:21px 15px}.rect[_ngcontent-%COMP%]{margin:21px 7px}}.row[_ngcontent-%COMP%]{width:300px;margin:0 auto;display:flex;justify-content:space-around}"]})}}return o})();function w(o,h){if(1&o){const e=t.RV6();t.j41(0,"ion-item"),t.EFF(1," Software version \xa0"),t.j41(2,"span",6),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.debugCheck())}),t.EFF(3),t.k0s(),t.EFF(4,"."),t.j41(5,"span",7),t.EFF(6," :: debugging ::"),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(3),t.JRh(e.version),t.R7$(2),t.Y8G("hidden",!e.newDebugOn)}}function H(o,h){if(1&o){const e=t.RV6();t.j41(0,"span")(1,"ion-item")(2,"ion-label"),t.EFF(3,"Alarm sounds"),t.k0s(),t.j41(4,"ion-button",8),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.changeAlarm())}),t.nrm(5,"ion-icon",9)(6,"ion-icon",10),t.k0s()(),t.j41(7,"ion-item"),t.EFF(8),t.nI1(9,"number"),t.j41(10,"ion-thumbnail",11)(11,"div",12),t.nrm(12,"div",13),t.k0s()()(),t.j41(13,"ion-item"),t.EFF(14),t.j41(15,"ion-thumbnail",11)(16,"div",14),t.nrm(17,"div",15),t.k0s()()()()}if(2&o){const e=t.XpG();t.R7$(4),t.Y8G("disabled",e.disableChangeAlarm),t.R7$(),t.Y8G("hidden",!e.alarmOn),t.R7$(),t.Y8G("hidden",e.alarmOn),t.R7$(2),t.SpI("Lock Voltage: ",t.i5U(9,9,e.lockVoltage,"1.1-1"),"V "),t.R7$(4),t.xc7("width",e.remaining),t.R7$(2),t.SpI("Signal Level: ",e.signalLevel," dBm "),t.R7$(3),t.xc7("width",e.signalLevelBar)}}let L=(()=>{class o{constructor(e,i,n,s){this.alertController=e,this.modalController=i,this.navParams=n,this.bleService=s,this.lockVoltage=0,this.alarmOn=!1,this.signalLevel=-98,this.signalLevelBar="0%",this.faq_url="",this.connected=!1,this.version="",this.messageHandler=a=>{},this.debugOn=!1,this.remaining="0%",this.response={},this.tapCount=0,this.hideDebugKeypad=!0,this.newDebugOn=!1,this.disableChangeAlarm=!1,this.rssiTimer=null}ionViewWillEnter(){this.alarmOn=this.navParams.get("alarmOn")??!1,this.lockVoltage=this.navParams.get("lockVoltage")??0,this.faq_url=this.navParams.get("url")??"",this.connected=this.navParams.get("connected")??!1,this.version=this.navParams.get("version")??"",this.messageHandler=this.navParams.get("messageHandler")??(i=>{}),this.debugOn=this.navParams.get("debugOn")??!1,this.newDebugOn=this.debugOn,this.disableChangeAlarm=!1;const e=Math.round(100*this.lockVoltage/6);this.remaining=e.toString()+"%",this.response={},this.tapCount=0,this.hideDebugKeypad=!0,this.startRssiReader()}debugCheck(){this.tapCount++,this.tapCount>4&&(this.newDebugOn?this.newDebugOn=!1:this.hideDebugKeypad=!1,this.tapCount=0)}codeEvent(e){this.hideDebugKeypad=!0,null!==e&&"3917"===e&&(this.newDebugOn=!this.newDebugOn)}openFaq(){var e=this;return(0,l.A)(function*(){yield I.open({url:"http://"+e.faq_url,presentationStyle:"fullscreen"})})()}changeAlarm(){var e=this;return(0,l.A)(function*(){try{e.disableChangeAlarm=!0,e.messageHandler("setting alarm to "+!e.alarmOn),e.alarmOn=!e.alarmOn,yield e.bleService.setAlarmState(e.alarmOn),e.response.alarmOn=e.alarmOn}catch(i){let n="string"==typeof i?i:JSON.stringify(i);e.messageHandler("set failed "+n),alert(n)}finally{e.disableChangeAlarm=!1}})()}clearCodes(){this.themedAlert("Caution!","You are about to erase all PIN codes.  Continue?").then(e=>{"Yes"===e&&(this.response.clear=!0)})}startRssiReader(){this.rssiTimer=window.setInterval(()=>{this.bleService.readRSSI().then(e=>{this.signalLevel=e,this.signalLevelBar=Math.min(1.25*(100+e),100)+"%",console.log("read RSSI: "+e)}).catch(e=>{console.log("unable to read RSSI:"+e),this.signalLevel=100,this.stopRssiReader()})},2500)}stopRssiReader(){this.rssiTimer&&clearInterval(this.rssiTimer),this.rssiTimer=null}finished(){var e=this;return(0,l.A)(function*(){e.debugOn!==e.newDebugOn&&(e.response.debug=e.newDebugOn),e.stopRssiReader(),yield e.modalController.dismiss(e.response)})()}themedAlert(e,i){var n=this;return(0,l.A)(function*(){const s=yield n.alertController.create({header:e,message:i,cssClass:"themedAlert",buttons:[{text:"Yes",handler:()=>(s.dismiss(!0),!1)},{text:"Cancel",handler:()=>(s.dismiss(!1),!1)}],backdropDismiss:!1});return s.present(),s.onDidDismiss()})()}static{this.\u0275fac=function(i){return new(i||o)(t.rXU(c.hG),t.rXU(c.W3),t.rXU(O.y8),t.rXU(g.Xt))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["ble-lock-options"]],decls:19,vars:7,consts:[[4,"ngIf"],[1,"faq-link",3,"click"],["color","light","size","large","slot","end",3,"click"],["name","remove-circle-outline"],[1,"done",3,"click","disabled"],["id","debug-keypad-pane",3,"pinValue","hidden","title","digits"],[3,"click"],[1,"debugText",3,"hidden"],["color","light","size","large","slot","end",3,"click","disabled"],["name","volume-high",3,"hidden"],["name","volume-off",3,"hidden"],["color","light","slot","end",1,"appear-as-button"],[1,"charge"],[1,"remaining"],[1,"signal"],[1,"signal-level"]],template:function(i,n){1&i&&(t.j41(0,"ion-card")(1,"div"),t.DNE(2,w,7,2,"ion-item",0),t.j41(3,"ion-item",1),t.bIt("click",function(){return n.openFaq()}),t.j41(4,"div"),t.EFF(5," For more information about your Tactical Traps lock, visit the website at "),t.j41(6,"span"),t.EFF(7),t.k0s(),t.EFF(8,". "),t.k0s()(),t.DNE(9,H,18,12,"span",0),t.j41(10,"ion-item"),t.EFF(11,"Clear all stored PIN codes "),t.j41(12,"ion-button",2),t.bIt("click",function(){return n.clearCodes()}),t.nrm(13,"ion-icon",3),t.k0s()(),t.j41(14,"p"),t.EFF(15,"\xa0"),t.k0s(),t.j41(16,"ion-button",4),t.bIt("click",function(){return n.finished()}),t.EFF(17,"Done"),t.k0s()()(),t.j41(18,"ble-lock-keypad",5),t.bIt("pinValue",function(a){return n.codeEvent(a)}),t.k0s()),2&i&&(t.R7$(2),t.Y8G("ngIf",!n.connected),t.R7$(5),t.JRh(n.faq_url),t.R7$(2),t.Y8G("ngIf",n.connected),t.R7$(7),t.Y8G("disabled",n.disableChangeAlarm),t.R7$(2),t.Y8G("hidden",n.hideDebugKeypad)("title","Enter 4-digit Code")("digits",4))},dependencies:[m.bT,c.Jm,c.b_,c.iq,c.uz,c.he,c.Zx,S,m.QX],styles:[".options-modal[_ngcontent-%COMP%]{overflow-y:auto!important}.options-modal.sc-ion-card-md-h.sc-ion-card-md-s.md.hydrated[_ngcontent-%COMP%]{justify-content:start;font-size:large;margin:8% 0;height:84%;overflow-y:auto}ion-item[_ngcontent-%COMP%]{--inner-padding-top: 9%;--inner-padding-bottom: 9%}.debugText[_ngcontent-%COMP%]{color:red;font-weight:700;padding-left:2rem}.faq-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#0b62f2;display:contents}.appear-as-button[_ngcontent-%COMP%]{width:68px;height:56px}.charge[_ngcontent-%COMP%]{height:20%;width:100%;margin-top:37%;display:inline-block;background-color:#193b19}.remaining[_ngcontent-%COMP%]{height:100%;background-color:#61e461}.signal[_ngcontent-%COMP%]{height:20%;width:100%;margin-top:37%;display:inline-block;background-color:#431f04}.signal-level[_ngcontent-%COMP%]{height:100%;background-color:#fb750f}.done[_ngcontent-%COMP%]{--background: #0B62F2;margin:-20px auto 20px 38%}#debug-keypad-pane[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#000}@media only screen and (min-width: 375px){ion-item[_ngcontent-%COMP%]{--inner-padding-top: 3%;--inner-padding-bottom: 3%}.done[_ngcontent-%COMP%]{margin-left:40%}}@media only screen and (min-width: 480px){.done[_ngcontent-%COMP%]{margin-left:45%}}"]})}}return o})();var j=r(101);const E=o=>({dimmed:o}),x=o=>({"unlock-spinner-reveal":o});function N(o,h){if(1&o){const e=t.RV6();t.j41(0,"img",16),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.beginConnect())}),t.k0s()}if(2&o){const e=t.XpG();t.BMQ("data-pairing-state",e.pairingState)}}function V(o,h){if(1&o){const e=t.RV6();t.j41(0,"img",17),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.beginDisconnect())}),t.k0s()}if(2&o){const e=t.XpG();t.BMQ("data-pairing-state",e.pairingState)}}function G(o,h){if(1&o){const e=t.RV6();t.j41(0,"img",18),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.unlock((null==n.lockStatus||null==n.lockStatus.randData?null:n.lockStatus.randData.toString())||""))}),t.k0s()}if(2&o){const e=t.XpG();t.Y8G("src","../../assets/"+(e.showLockOpen?"lock":"unlock")+"-btn.png",t.B4B),t.BMQ("data-show-lock-open",e.showLockOpen)("data-is-lock-pending",e.isLockOperationPending)}}function K(o,h){if(1&o&&t.nrm(0,"ion-spinner",19),2&o){const e=t.XpG();t.Y8G("ngClass",t.eq3(2,x,e.isLockOperationPending)),t.BMQ("data-is-lock-pending",e.isLockOperationPending)}}function B(o,h){if(1&o){const e=t.RV6();t.j41(0,"div",28),t.bIt("click",function(){const n=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.select(n))}),t.nrm(1,"ion-icon",29),t.j41(2,"span",30),t.EFF(3),t.k0s()()}if(2&o){const e=h.$implicit;t.R7$(3),t.JRh(e.name||"Unknown Device")}}function z(o,h){if(1&o){const e=t.RV6();t.j41(0,"ion-card",20)(1,"ion-card-header")(2,"ion-card-title")(3,"span",21),t.EFF(4,"AVAILABLE DEVICES"),t.k0s(),t.j41(5,"span",21),t.EFF(6,"SELECT A DEVICE"),t.k0s(),t.j41(7,"span",21),t.EFF(8,"CONNECTING TO:"),t.k0s()()(),t.j41(9,"ion-card-content")(10,"div",22),t.DNE(11,B,4,1,"div",23),t.k0s(),t.j41(12,"div",24),t.EFF(13," Scanning "),t.nrm(14,"ion-spinner"),t.k0s(),t.j41(15,"div",25)(16,"div",26),t.EFF(17),t.k0s(),t.nrm(18,"ion-spinner"),t.k0s(),t.j41(19,"ion-button",27),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancel())}),t.EFF(20,"CANCEL"),t.k0s()()()}if(2&o){const e=t.XpG();t.BMQ("data-pairing-state",e.pairingState),t.R7$(3),t.Y8G("hidden",e.pairingState>=e.waiting),t.R7$(2),t.Y8G("hidden",e.pairingState!==e.waiting),t.R7$(2),t.Y8G("hidden",e.pairingState!==e.connecting),t.R7$(3),t.Y8G("hidden",e.pairingState>=e.connecting),t.R7$(),t.Y8G("ngForOf",e.devices),t.R7$(),t.Y8G("hidden",e.pairingState!==e.scanning),t.R7$(3),t.Y8G("hidden",e.pairingState!==e.connecting),t.R7$(2),t.JRh(e.selectedDevice.name),t.R7$(2),t.Y8G("hidden",e.pairingState>=e.connecting)}}function Y(o,h){if(1&o){const e=t.RV6();t.j41(0,"ble-lock-keypad",31),t.bIt("pinValue",function(n){t.eBV(e);const s=t.XpG();return t.Njj(s.pinEvent(n))}),t.k0s()}if(2&o){const e=t.XpG();t.Y8G("title","Enter 4-digit PIN")("digits",4),t.BMQ("data-hide-keypad",e.hideKeypad)}}function X(o,h){if(1&o){const e=t.RV6();t.j41(0,"ion-fab-button",34),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.showAlarmState())}),t.EFF(1,"Alarm"),t.k0s()}}function U(o,h){if(1&o){const e=t.RV6();t.j41(0,"ion-fab-button",34),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.unlock((null==n.lockStatus||null==n.lockStatus.randData?null:n.lockStatus.randData.toString())||""))}),t.EFF(1,"Unlock"),t.k0s()}}function Z(o,h){if(1&o){const e=t.RV6();t.j41(0,"ion-fab-button",34),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.beginDisconnect())}),t.EFF(1,"Dsc"),t.k0s()}}function W(o,h){if(1&o){const e=t.RV6();t.j41(0,"ion-fab-button",34),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.bleService.initializeLock())}),t.EFF(1,"Reset"),t.k0s()}}function J(o,h){if(1&o){const e=t.RV6();t.j41(0,"ion-fab",32)(1,"ion-fab-button"),t.EFF(2,"Tools"),t.k0s(),t.j41(3,"ion-fab-list",33)(4,"ion-fab-button",34),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.debugMode.active=!n.debugMode.active)}),t.EFF(5),t.k0s(),t.DNE(6,X,2,0,"ion-fab-button",35)(7,U,2,0,"ion-fab-button",35)(8,Z,2,0,"ion-fab-button",35),t.j41(9,"ion-fab-button",34),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.clearTestOutput())}),t.EFF(10,"Clear"),t.k0s(),t.DNE(11,W,2,0,"ion-fab-button",35),t.k0s()()}if(2&o){const e=t.XpG();t.R7$(5),t.JRh(e.debugMode.active?"Hide":"Show"),t.R7$(),t.Y8G("ngIf",e.pairingState===e.successful),t.R7$(),t.Y8G("ngIf",e.pairingState===e.successful),t.R7$(),t.Y8G("ngIf",e.pairingState===e.successful),t.R7$(3),t.Y8G("ngIf",e.pairingState===e.successful)}}const te=[{path:"",component:(()=>{class o{constructor(e,i,n,s,a,d,f,p){this.bleService=e,this.devList=i,this.lockData=n,this.platform=s,this.ngZone=a,this.alertController=d,this.modalController=f,this.cdr=p,this.devices=[],this.LastConnected="last connected",this.pairingState=0,this.inactive=0,this.scanning=1,this.waiting=2,this.connecting=3,this.successful=4,this.failed=5,this.activeLockState=0,this.s_unconnected=0,this.s_checkPosition=1,this.s_openWait=2,this.s_closed=3,this.s_unlockWait=4,this.s_lockWait=5,this.s_sleepWait=6,this.oneSecond=1e3,this.scanTime=3*this.oneSecond,this.scanAttempts=3,this.timeIncrement=500,this.timeDivider=4,this.sleepDelay=60*this.oneSecond,this.sleepTimer=-1,this.versionNumber=null,this.bleAlertDialog=null,this.verifyFailedDialog=null,this.deviceToAuthorize=null,this.authorizationNotCached=!1,this.scanInterval=null,this.scanController=null,this.scanResult=null,this.connectSubscription=null,this.pollInterval=null,this.mustReadStatus=!1,this.mustReadAlarm=!1,this.disconnectTimer=null,this.tickCounter=0,this.pauseCountdownForAlert=!1,this.modalRef=null,this.optionsDisable=!1,this.alarmOn=!0,this.lockStatus=null,this.lockVoltage=-1,this.debugMode={active:!1,showFAB:!1,console:!D.c.production,internal:!0},this.selectedDevice={name:""},this.testPaneDepth=0,this.showLockOpen=!1,this.hideKeypad=!0,this.testOutput="",this.isLockOperationPending=!1}ngOnInit(){var e=this;return(0,l.A)(function*(){e.lockData.setup(e.messageHandler.bind(e)),yield e.debugSetup(),e.activeLockState=e.s_unconnected,e.showLockOpen=!1,e.pairingState=e.inactive,e.hideKeypad=!0,e.isLockOperationPending=!1,e.messageHandler(`ngOnInit: pairingState=${e.pairingState}, showLockOpen=${e.showLockOpen}, hideKeypad=${e.hideKeypad}, isLockOperationPending=${e.isLockOperationPending}`),e.cdr.detectChanges()})()}ngAfterViewInit(){var e=this;this.platform.ready().then((0,l.A)(function*(){const i=yield M.getInfo();e.versionNumber=i.version,e.messageHandler("version "+i.version);try{if(e.bleService.setup(e.messageHandler.bind(e),e.bleMessageHandler.bind(e)),yield e.bleService.isAvailable()){const s=yield e.checkForDroppedConnection();null!==s&&(yield e.bleService.forceDisconnect(s),e.messageHandler("Forced disconnect successful for "+s.id),e.ngZone.run(()=>{e.pairingState=e.inactive,e.hideKeypad=!0,e.isLockOperationPending=!1,e.messageHandler(`ngAfterViewInit: forced disconnect, pairingState=${e.pairingState}, hideKeypad=${e.hideKeypad}`),e.cdr.detectChanges()}))}}catch(n){yield e.showErrorAlert("Bluetooth Error","Bluetooth setup failed: "+String(n))}e.ngZone.run(()=>{e.messageHandler("ngAfterViewInit: complete"),e.cdr.detectChanges()})}))}beginConnect(){this.messageHandler("beginConnect"),this.pairingState===this.inactive?this.bleService.isAvailable().then(e=>{this.messageHandler("available: "+e),e?this.scanForDevices():(this.themedAlert("Bluetooth Disabled","Please enable Bluetooth and location services."),this.ngZone.run(()=>{this.pairingState=this.inactive,this.hideKeypad=!0,this.messageHandler(`beginConnect: Bluetooth disabled, pairingState=${this.pairingState}`),this.cdr.detectChanges()}))}).catch(e=>{this.safeAlert("Bluetooth Error on connect\n"+String(e))}):this.messageHandler("connection requested already")}scanForDevices(){let e=3;this.messageHandler("starting ble scan");const i=[this.bleService.LongServiceUuid];this.optionsDisable=!0,this.devList.reset(),this.devices=[],this.scanController=new F.B,this.scanController.subscribe(s=>{let a=Promise.resolve();switch(this.scanResult&&(this.scanResult.unsubscribe(),this.scanResult=null,a=this.bleService.stopScan(),a.catch(()=>{alert("Something went wrong while scanning for devices"),this.messageHandler("scan failed to stop"),this.ngZone.run(()=>{this.pairingState=this.failed,this.cdr.detectChanges()})})),this.scanInterval&&(clearInterval(this.scanInterval),this.scanInterval=null),s.action){case"begin":this.messageHandler("begin scan"),this.pairingState=this.scanning,e=this.scanAttempts,this.scanResult=this.initiateCycle(i),this.ngZone.run(()=>{this.messageHandler(`scanForDevices: pairingState=${this.pairingState}`),this.cdr.detectChanges()});break;case"timeout":this.ngZone.run(()=>{this.devices=this.devList.getDevices(),this.messageHandler("timeout, attempt "+e),this.cdr.detectChanges()}),a.then(()=>{--e>0?this.scanResult=this.initiateCycle(i):0===this.devices.length?(this.ngZone.run(()=>{this.pairingState=this.failed,this.messageHandler(`scanForDevices: no devices, pairingState=${this.pairingState}`),this.cdr.detectChanges()}),this.themedAlert("No Devices","No Bluetooth devices were detected").then(()=>{this.ngZone.run(()=>{this.pairingState=this.inactive,this.optionsDisable=!1,this.messageHandler(`scanForDevices: reset, pairingState=${this.pairingState}`),this.cdr.detectChanges()})})):this.ngZone.run(1===this.devices.length&&this.devices[0].hasProperName?()=>{this.messageHandler("scan stopped, one device found"),this.pairingState=this.waiting,this.selectedDevice=this.devices[0],this.checkForPinCode(this.devices[0]),this.messageHandler(`scanForDevices: one device, pairingState=${this.pairingState}`),this.cdr.detectChanges()}:()=>{this.devices=this.devList.getDevices(),this.messageHandler("scan stopped, "+this.devices.length+" devices found"),this.pairingState=this.waiting,this.messageHandler(`scanForDevices: multiple devices, pairingState=${this.pairingState}`),this.cdr.detectChanges()})});break;case"select":a.then(()=>{this.ngZone.run(()=>{this.devices=[s.device],this.pairingState=this.waiting,this.selectedDevice=s.device,this.checkForPinCode(s.device),this.messageHandler(`scanForDevices: device selected, pairingState=${this.pairingState}`),this.cdr.detectChanges()})});break;case"cancel":a.then(()=>{this.ngZone.run(()=>{this.pairingState=this.inactive,this.optionsDisable=!1,this.hideKeypad=!0,this.messageHandler(`scanForDevices: canceled, pairingState=${this.pairingState}, hideKeypad=${this.hideKeypad}`),this.cdr.detectChanges()})});break;default:this.messageHandler("bad selection")}}),this.scanController.next({action:"begin"})}select(e){this.messageHandler("selecting device "+e.name),this.scanController?.next({action:"select",device:e})}cancel(){this.messageHandler("cancel"),this.scanController?.next({action:"cancel"})}initiateCycle(e){let n=!0;const s=this.bleService.startScan(e).subscribe(a=>{let d=!0;a.hasProperName=!!(a.name&&a.name.length>0),a.hasLongUuids=!0,a.hasProperName||(a.name="Unknown Device"),this.platform.is("ios")&&(a.advertising.hasOwnProperty("kCBAdvDataLocalName")?a.hasLongUuids=a.advertising.kCBAdvDataServiceUUIDs[0].length>4:d=!1),d&&(this.ngZone.run(()=>{this.devices=this.devList.addDevice(a),this.messageHandler(`initiateCycle: device added, devices=${this.devices.length}`),this.cdr.detectChanges()}),n&&(this.devicePaneSizing(),n=!1))});return this.scanInterval=window.setInterval(()=>{this.scanController?.next({action:"timeout"})},this.scanTime),s}checkForPinCode(e){this.messageHandler("checkForPinCode, device "+e.name),this.deviceToAuthorize=e,this.lockData.getAuthorization(e.name).then(i=>{this.authorizationNotCached=!1,this.pairToDevice(i)}).catch(i=>{this.authorizationNotCached=!0,this.ngZone.run(()=>{this.hideKeypad=!1,this.testPaneDepth=-1,this.messageHandler(`checkForPinCode: no PIN, hideKeypad=${this.hideKeypad}, testPaneDepth=${this.testPaneDepth}`),this.cdr.detectChanges()})})}pinEvent(e){this.ngZone.run(()=>{this.hideKeypad=!0,this.testPaneDepth=0,null===e?this.pairingState=this.inactive:this.pairToDevice(e),this.messageHandler(`pinEvent: result=${e}, hideKeypad=${this.hideKeypad}, pairingState=${this.pairingState}`),this.cdr.detectChanges()})}pairToDevice(e){var i=this;return(0,l.A)(function*(){const n=i;i.messageHandler(`pairToDevice "${e}"`),i.ngZone.run(()=>{i.pairingState=i.connecting,i.hideKeypad=!0,i.messageHandler(`pairToDevice: pairingState=${i.pairingState}, hideKeypad=${i.hideKeypad}`),i.cdr.detectChanges()});const s=i.deviceToAuthorize,a=i.lockData.makeLock(s.name,e);i.connectSubscription=i.bleService.connectTo(s).subscribe(function(){var d=(0,l.A)(function*(f){try{yield n.bleService.waitForMilliseconds(200);const p=yield n.bleService.handleVerification(a);if(p.verified){if(n.messageHandler("PIN code verified"),n.authorizationNotCached)try{const u=yield n.lockData.addAuthorization(a);if(u!==k.h.SUCCESS){const _=`couldn't cache authorization: error ${u}`;n.messageHandler(_),alert(_)}}catch(u){const _="addAuthorization failed: error "+JSON.stringify(u);n.messageHandler(_),alert(_)}n.activeLockState=n.s_checkPosition,n.ngZone.run(()=>{n.pairingState=n.successful,n.hideKeypad=!0,n.isLockOperationPending=!1,n.messageHandler(`pairToDevice: success, pairingState=${n.pairingState}, showLockOpen=${n.showLockOpen}, hideKeypad=${n.hideKeypad}, isLockOperationPending=${n.isLockOperationPending}`),n.cdr.detectChanges()}),n.mustReadStatus=!0,yield n.timeTickHandler(),n.alarmOn=yield i.bleService.getAlarmState(),n.ngZone.run(()=>{n.optionsDisable=!1,n.messageHandler("pairToDevice: options enabled"),n.cdr.detectChanges()}),n.pollInterval=window.setInterval(n.timeTickHandler.bind(n),n.timeIncrement),n.messageHandler("polling started")}else n.messageHandler("verify was unsuccessful: "+p.msg),n.verifyFailed(p.isError?`PIN verification was not successful, result: ${p.msg}. Waiting for disconnect.`:"The PIN does not match the lock. You may try again in 30 seconds."),n.ngZone.run(()=>{n.pairingState=n.failed,n.hideKeypad=!0,n.messageHandler(`pairToDevice: failed, pairingState=${n.pairingState}, hideKeypad=${n.hideKeypad}`),n.cdr.detectChanges()})}catch(p){const u=`PIN verification failed due to: ${String(p)}`;n.messageHandler(u),n.verifyFailed(u),n.disconnectTimer=window.setTimeout((0,l.A)(function*(){yield n.bleService.putLockToSleep()}),5e3)}});return function(f){return d.apply(this,arguments)}}(),function(){var d=(0,l.A)(function*(f){n.cleanup(),n.touchConnection({reset:!0}),n.ngZone.run(()=>{n.pairingState=i.inactive,n.hideKeypad=!0,n.isLockOperationPending=!1,n.messageHandler(`pairToDevice: disconnected, pairingState=${n.pairingState}, hideKeypad=${n.hideKeypad}, isLockOperationPending=${n.isLockOperationPending}`),n.cdr.detectChanges()}),null!==n.verifyFailedDialog?(yield n.verifyFailedDialog.dismiss(),n.verifyFailedDialog=null):null!==n.modalRef?(yield n.modalRef.dismiss(),n.themedAlert("Disconnected","The lock disconnected due to inactivity.")):n.activeLockState!==n.s_sleepWait&&f.connectFailed&&n.themedAlert("Connection Error","Incomplete connection\nPlease try again"),n.activeLockState=n.s_unconnected,n.ngZone.run(()=>{n.optionsDisable=!1,n.messageHandler("pairToDevice: options enabled after disconnect"),n.cdr.detectChanges()})});return function(f){return d.apply(this,arguments)}}())})()}verifyFailed(e){var i=this;return(0,l.A)(function*(){return i.verifyFailedDialog=yield i.alertController.create({header:"Access Denied",message:e,buttons:[],backdropDismiss:!1}),yield i.verifyFailedDialog.present()})()}timeTickHandler(){var e=this;return(0,l.A)(function*(){if(!e.pauseCountdownForAlert){if(null===e.connectSubscription)return void e.messageHandler(`tried to handle timer tick after disconnect, mustReadStatus=${e.mustReadStatus}`);try{if(e.sleepTimer>-1&&null===e.modalRef&&(e.sleepTimer+=e.timeIncrement),e.bleService.isLockBusy())e.messageHandler("timeTickHandler: lock busy, skipping");else if(e.sleepTimer>=e.sleepDelay&&null===e.modalRef)e.sleepTimer=-1,e.mustReadStatus=!1,e.messageHandler("putting lock to sleep"),e.bleService.putLockToSleep().then(()=>{e.ngZone.run(()=>{e.pairingState=e.inactive,e.hideKeypad=!0,e.isLockOperationPending=!1,e.activeLockState=e.s_sleepWait,e.messageHandler(`timeTickHandler: sleep, pairingState=${e.pairingState}, hideKeypad=${e.hideKeypad}, isLockOperationPending=${e.isLockOperationPending}`),e.cdr.detectChanges()})}).catch(i=>{e.safeAlert(String(i))});else if(e.mustReadAlarm)e.mustReadAlarm=!1,e.alarmOn=yield e.bleService.getAlarmState(),e.messageHandler(`timeTickHandler: alarmOn=${e.alarmOn}`);else if(e.mustReadStatus){e.mustReadStatus=!1,e.lockStatus=yield e.bleService.readLockStatus();const i=e.simplifyState(e.lockStatus);e.lockVoltage=e.lockStatus&&void 0!==e.lockStatus.voltageValue?e.lockStatus.voltageValue/1e3:-1,e.ngZone.run(()=>{if(e.lockStatus.isStatus)switch(e.messageHandler(`Lock State: ${i}`),e.activeLockState){case e.s_checkPosition:e.lockStatus.openCloseState!==g.nk?(e.messageHandler("checking: lock already open"),e.activeLockState=e.s_openWait,e.showLockOpen=!0):(e.messageHandler("checking: lock closed"),e.activeLockState=e.s_closed,e.showLockOpen=!1),e.isLockOperationPending=!1;break;case e.s_unlockWait:e.lockStatus.openCloseState!==g.nk&&(e.messageHandler("status: lock now open"),e.activeLockState=e.s_lockWait,e.showLockOpen=!0,e.isLockOperationPending=!1),e.mustReadStatus=!0;break;case e.s_lockWait:e.lockStatus.openCloseState===g.nk&&e.lockStatus.hookState!==g.Mf?(e.messageHandler("status: shelf now closed"),e.activeLockState=e.s_closed,e.showLockOpen=!1,e.isLockOperationPending=!1):e.mustReadStatus=!0;break;default:e.safeAlert("invalid lock state")}else e.lockStatus.response!==g.Nt&&e.messageHandler(`Bad response in [${e.activeLockState}] at ${e.sleepTimer/100} :: ${i}`),e.mustReadStatus=!0;e.messageHandler(`timeTickHandler: showLockOpen=${e.showLockOpen}, isLockOperationPending=${e.isLockOperationPending}, activeLockState=${e.activeLockState}`),e.cdr.detectChanges()})}}catch(i){e.ngZone.run(()=>{e.messageHandler("polling error: "+String(i)),e.cdr.detectChanges()})}e.tickCounter=(e.tickCounter+1)%e.timeDivider,!e.tickCounter&&e.deviceToAuthorize&&e.touchConnection({device:e.deviceToAuthorize})}})()}unlock(e){const i=this;let n;this.ngZone.run(()=>{this.isLockOperationPending=!0,this.optionsDisable=!0,this.messageHandler(`unlock: isLockOperationPending=${this.isLockOperationPending}, activeLockState=${this.activeLockState}`),this.cdr.detectChanges()}),this.activeLockState===this.s_closed?(this.messageHandler("attempting 5-second relock"),n="auto-relock"):(this.messageHandler("attempting to close open lock"),n="toggle"),this.bleService.triggerLock(n,e).then(s=>{i.ngZone.run(()=>{if(s.response!==g.Nt){i.isLockOperationPending=!1,i.optionsDisable=!1;const a=i.simplifyState(s),d=`Bad command result, state ${i.activeLockState} = ${a}`;i.messageHandler(d),alert(d)}else i.activeLockState===i.s_closed&&(i.activeLockState=i.s_unlockWait),i.mustReadStatus=!0;i.messageHandler(`unlock: isLockOperationPending=${i.isLockOperationPending}, activeLockState=${i.activeLockState}`),i.cdr.detectChanges()})}).catch(s=>{i.ngZone.run(()=>{i.isLockOperationPending=!1,i.optionsDisable=!1,i.messageHandler("unlock failed: "+JSON.stringify(s)),i.cdr.detectChanges()})})}beginDisconnect(){this.messageHandler("beginDisconnect"),this.activeLockState!==this.s_lockWait&&(this.messageHandler("scheduling immediate sleep"),this.sleepTimer=this.sleepDelay)}checkForDroppedConnection(){var e=this;return(0,l.A)(function*(){let i=null;try{const n=yield e.lockData.getJsonValue(e.LastConnected);if(e.messageHandler(`checkForDroppedConnection: value=${JSON.stringify(n)}`),!n||!n.touchedAt)return e.messageHandler("Invalid or missing connection data."),null;if(!n.id)return e.messageHandler("Invalid connection data: missing device ID."),yield e.showInfoAlert("Invalid Data","The stored connection data is incomplete. Please connect to a lock."),null;let s=!1;try{yield e.bleService.isConnected(n.id),s=!0,e.messageHandler(`Device ${n.id} is still connected.`)}catch(d){e.messageHandler(`isConnected failed for ${n.id}: ${d instanceof Error?d.message:String(d)}`),s=!1}const a=(Date.now()-n.touchedAt)/1e3;a<g.zW?(i=n,e.messageHandler(`Connection within ${g.zW} seconds, setting device: ${i.id}`)):(e.messageHandler(`Connection inactive for ${a} seconds, exceeding ${g.zW} seconds.`),yield e.showInfoAlert("Connection Expired",`The last connection was ${Math.floor(a)} seconds ago, exceeding the ${g.zW}-second limit. Please reconnect to a lock.`)),e.touchConnection({reset:!s}),!s&&i&&(yield e.showWarningAlert("Dropped Connection",`The lock with ID ${i.id} appears to have been disconnected. Would you like to force disconnect?`,[{text:"Yes",handler:()=>e.bleService.forceDisconnect(i)},{text:"No",handler:()=>{}}]))}catch(n){e.messageHandler(`Error in checkForDroppedConnection: ${JSON.stringify(n)}`);let s="An unexpected error occurred while checking for a dropped connection.";return n instanceof Error?s+=` Details: ${n.message}. Please try again or restart the app.`:"object"==typeof n&&null!==n?n.code===k.h.ITEM_NOT_FOUND?s="No previous connection data found. Please connect to a lock to proceed.":s+=` Details: ${JSON.stringify(n)}. Please contact support if this persists.`:s+=" Details: Unknown error. Please restart the app or contact support.",yield e.showErrorAlert("Connection Error",s),null}return i})()}showInfoAlert(e,i){var n=this;return(0,l.A)(function*(){yield(yield n.alertController.create({header:e,message:i,buttons:["OK"],backdropDismiss:!1})).present()})()}showWarningAlert(e,i,n){var s=this;return(0,l.A)(function*(){yield(yield s.alertController.create({header:e,message:i,buttons:n,backdropDismiss:!1})).present()})()}showErrorAlert(e,i){var n=this;return(0,l.A)(function*(){yield(yield n.alertController.create({header:e,message:i,buttons:["OK"],backdropDismiss:!1})).present(),n.messageHandler(`Error alert shown: ${i}`)})()}touchConnection({device:e,reset:i=!1}={}){let n;n=i?{...e,touchedAt:0,id:e.id||""}:{...e,touchedAt:Date.now(),advertising:null,id:e.id||""},this.lockData.setJsonValue(this.LastConnected,n).catch(s=>{alert("touchConnection: "+JSON.stringify(s))})}simplifyState(e){return`${g.oV[e.response]||"Unknown"}, locked: ${e.openCloseState===g.nk}, hooked: ${e.hookState!==g.Mf}`}devicePaneSizing(){const e=document.getElementById("device-pane");if(e){const i=e.offsetTop+"px";document.getElementsByTagName("ion-content")[0].style.setProperty("--device-pane-top",i)}}cleanup(){this.scanResult&&(this.scanResult.unsubscribe(),this.scanResult=null),this.connectSubscription&&(this.connectSubscription.unsubscribe(),this.connectSubscription=null),this.pollInterval&&(clearInterval(this.pollInterval),this.pollInterval=null,this.messageHandler("polling stopped")),this.disconnectTimer&&(clearTimeout(this.disconnectTimer),this.disconnectTimer=null)}openOptionsModal(){var e=this;return(0,l.A)(function*(){e.optionsDisable?e.messageHandler("N/A: modal already active"):(e.messageHandler(`openOptionsModal: alarm=${e.alarmOn?"on":"off"}, pairingState=${e.pairingState}`),e.pairingState===e.inactive||e.pairingState===e.successful?(e.optionsDisable=!0,e.pairingState===e.successful?(e.alarmOn=yield e.bleService.getAlarmState(),e.messageHandler(`alarmOn=${e.alarmOn}`)):e.alarmOn=!1,e.modalRef=yield e.modalController.create({component:L,componentProps:{alarmOn:e.alarmOn,lockVoltage:e.lockVoltage,url:"www.tacticaltraps.com/faqs/",connected:e.pairingState===e.successful,version:e.versionNumber,messageHandler:e.messageHandler.bind(e),debugOn:e.debugMode.active},cssClass:"options-modal"}),yield e.modalRef.present(),e.modalRef.onDidDismiss().then(function(){var i=(0,l.A)(function*(n){if(n?.data){if("alarmOn"in n.data&&(e.alarmOn=n.data.alarmOn),"clear"in n.data){const s=yield e.lockData.clear();e.messageHandler("clear(): "+String(s))}"debug"in n.data&&(e.debugMode.active=n.data.debug,e.debugMode.showFAB=n.data.debug,e.lockData.setValue("debugOn",e.debugMode.active.toString()).then(()=>{console.log("debug mode saved: "+e.debugMode.active)}).catch(s=>{console.log("debug setting write failed: "+JSON.stringify(s))}))}});return function(n){return i.apply(this,arguments)}}()).finally(()=>{e.modalRef=null,e.optionsDisable=!1,e.ngZone.run(()=>{e.messageHandler(`openOptionsModal exit: alarm=${e.alarmOn?"on":"off"}, pairingState=${e.pairingState}`),e.cdr.detectChanges()})})):e.messageHandler("N/A: connection logic active"))})()}bleMessageHandler(e,i){var n=this;return(0,l.A)(function*(){return null!==e?(typeof i>"u"&&(i=!1),n.bleAlertDialog=yield n.alertController.create({header:"Action required",message:e,buttons:i?["OK"]:[],backdropDismiss:!1}),yield n.bleAlertDialog.present()):n.bleAlertDialog&&(yield n.bleAlertDialog.dismiss()),n.bleAlertDialog.onDidDismiss()})()}safeAlert(e){this.pauseCountdownForAlert=!0,alert(e),this.pauseCountdownForAlert=!1}themedAlert(e,i){var n=this;return(0,l.A)(function*(){return yield(yield n.alertController.create({header:e||"Alert",message:i,cssClass:"themedAlert",buttons:["OK"],backdropDismiss:!1})).present()})()}debugSetup(){var e=this;return(0,l.A)(function*(){try{const i=yield e.lockData.getValue("debugOn");e.debugMode.active="true"===i,e.debugMode.showFAB=e.debugMode.active,console.log("debug mode set to "+i)}catch(i){i.code!==k.h.ITEM_NOT_FOUND&&e.messageHandler("debug setting read failed: "+JSON.stringify(i))}})()}messageHandler(e){const i=new Date,n=i.getMilliseconds().toString().padStart(3,"0"),s=i.getSeconds().toString().padStart(2,"0"),d=i.getMinutes().toString().padStart(2,"0")+"."+s+"."+n;this.debugMode.console&&console.log(d+" --- "+e),this.debugMode.active&&this.debugMode.internal&&(this.testOutput+=d+" --- "+e+"\n")}showAlarmState(){this.bleService.getAlarmState().then(e=>{this.messageHandler("alarm = "+(e?"on":"off"))})}clearTestOutput(){this.testOutput=""}static{this.\u0275fac=function(i){return new(i||o)(t.rXU(g.Xt),t.rXU(j.N),t.rXU(k.T),t.rXU(O.OD),t.rXU(t.SKi),t.rXU(c.hG),t.rXU(c.W3),t.rXU(t.gRc))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-home"]],decls:19,vars:16,consts:[[3,"fullscreen"],[1,"content"],["src","../../assets/logo.png",1,"logo",3,"click"],[1,"hr2"],[1,"title"],["slot","end","name","menu",3,"click","ngClass"],[1,"hr3"],[1,"lock-image",3,"src"],["class","connect click-sounds","src","../../assets/connect-btn.png",3,"click",4,"ngIf"],["class","connect click-sounds","src","../../assets/disconnect-btn.png",3,"click",4,"ngIf"],["class","unlock click-sounds",3,"src","click",4,"ngIf"],["class","unlock-spinner","color","secondary",3,"ngClass",4,"ngIf"],["id","device-pane",4,"ngIf"],["id","keypad-pane",3,"title","digits","pinValue",4,"ngIf"],[1,"test"],["vertical","bottom","horizontal","end",4,"ngIf"],["src","../../assets/connect-btn.png",1,"connect","click-sounds",3,"click"],["src","../../assets/disconnect-btn.png",1,"connect","click-sounds",3,"click"],[1,"unlock","click-sounds",3,"click","src"],["color","secondary",1,"unlock-spinner",3,"ngClass"],["id","device-pane"],[3,"hidden"],[1,"device-list",3,"hidden"],["class","item click-sounds",3,"click",4,"ngFor","ngForOf"],[1,"scanning",3,"hidden"],[1,"connecting",3,"hidden"],[1,"selectedDevice"],[1,"click-sounds",3,"click","hidden"],[1,"item","click-sounds",3,"click"],["name","bluetooth-outline",1,"device-icon"],[1,"device-name"],["id","keypad-pane",3,"pinValue","title","digits"],["vertical","bottom","horizontal","end"],["side","start"],[1,"click-sounds",3,"click"],["class","click-sounds",3,"click",4,"ngIf"]],template:function(i,n){1&i&&(t.j41(0,"ion-content",0)(1,"div",1)(2,"img",2),t.bIt("click",function(){return n.clearTestOutput()}),t.k0s(),t.nrm(3,"div",3),t.j41(4,"h1")(5,"div",4),t.EFF(6,"BLUETOOTH LOCK APPLICATION"),t.k0s(),t.j41(7,"ion-icon",5),t.bIt("click",function(){return n.openOptionsModal()}),t.k0s()(),t.nrm(8,"div",6)(9,"img",7),t.DNE(10,N,1,1,"img",8)(11,V,1,1,"img",9)(12,G,1,3,"img",10)(13,K,1,4,"ion-spinner",11)(14,z,21,10,"ion-card",12)(15,Y,1,3,"ble-lock-keypad",13),t.j41(16,"div",14),t.EFF(17),t.k0s()(),t.DNE(18,J,12,5,"ion-fab",15),t.k0s()),2&i&&(t.Y8G("fullscreen",!0),t.R7$(7),t.Y8G("ngClass",t.eq3(14,E,n.optionsDisable)),t.R7$(2),t.Y8G("src","../../assets/"+(n.showLockOpen?"open":"closed")+"-lock.png",t.B4B),t.BMQ("data-show-lock-open",n.showLockOpen),t.R7$(),t.Y8G("ngIf",n.pairingState===n.inactive||n.pairingState===n.failed),t.R7$(),t.Y8G("ngIf",n.pairingState===n.successful),t.R7$(),t.Y8G("ngIf",n.pairingState===n.successful&&!n.isLockOperationPending),t.R7$(),t.Y8G("ngIf",n.pairingState===n.successful&&n.isLockOperationPending),t.R7$(),t.Y8G("ngIf",n.pairingState===n.scanning||n.pairingState===n.waiting||n.pairingState===n.connecting),t.R7$(),t.Y8G("ngIf",!n.hideKeypad),t.R7$(),t.xc7("z-index",n.testPaneDepth),t.R7$(),t.JRh(n.testOutput),t.R7$(),t.Y8G("ngIf",n.debugMode.showFAB))},dependencies:[m.YU,m.Sq,m.bT,c.Jm,c.b_,c.I9,c.ME,c.tN,c.W9,c.Q8,c.YW,c.OL,c.iq,c.w2,S],styles:["ion-content[_ngcontent-%COMP%]{width:100%;height:100%;--notch-inset: 0;--color: black;--background: white url(app-background.66f76c1007be195d.jpg) left top / 100vw 100vh;--overflow: hidden}.content[_ngcontent-%COMP%]{position:absolute;top:var(--notch-inset);left:0;width:100%;height:calc(100% - var(--notch-inset))}.content[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{width:auto;height:12%;margin:3.45% auto 4%;display:block}.content[_ngcontent-%COMP%]   .hr2[_ngcontent-%COMP%]{height:.4%;background-color:#000;margin-bottom:4%}.content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{position:relative;margin-top:17px;margin-bottom:16px}.content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:.8rem;width:87%;text-align:center;font-weight:700;margin-bottom:4%;position:relative}.content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.1em;position:absolute;right:.3em;top:-.27em}.content[_ngcontent-%COMP%]   ion-icon.dimmed[_ngcontent-%COMP%]{color:#a8a8a8}.content[_ngcontent-%COMP%]   .hr3[_ngcontent-%COMP%]{height:.4%;background-color:#000;margin-bottom:3%}.content[_ngcontent-%COMP%]   .lock-image[_ngcontent-%COMP%]{width:auto;height:48%;margin:0 auto 1%;display:block}.content[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:auto;--color: white}.content[_ngcontent-%COMP%]   .connect[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .unlock[_ngcontent-%COMP%]{height:10%;margin:auto;display:block}.content[_ngcontent-%COMP%]   .unlock-spinner[_ngcontent-%COMP%]{display:block;margin:5rem auto;transform:scale(4.5);opacity:1}.content[_ngcontent-%COMP%]   .unlock-spinner-reveal[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn 5s;-webkit-animation:_ngcontent-%COMP%_fadeIn 5s}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:.1}to{opacity:1}}#device-pane[_ngcontent-%COMP%]{position:absolute;top:35%;max-height:calc(100vh - 2em - 35%);width:66%;left:0;right:0;margin:0 auto;overflow-y:scroll;background-color:#fff;--color: #3a3939;border:3px solid #808080;border-radius:2px;padding:10px;font-size:1rem;text-align:center;z-index:200}ion-card-title[_ngcontent-%COMP%]{font-size:1rem;--color: #282828;margin-bottom:3px}.device-list[_ngcontent-%COMP%]{margin-bottom:1.4rem}.device-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px;margin-bottom:.8em;border-radius:5px;background-color:#f9f9f9;transition:background-color .2s;cursor:pointer}.device-list[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.device-list[_ngcontent-%COMP%]   .device-icon[_ngcontent-%COMP%]{font-size:1.2rem;margin-right:10px;color:#007bff}.device-list[_ngcontent-%COMP%]   .device-name[_ngcontent-%COMP%]{font-size:1.1rem;line-height:1.5em;flex:1}.scanning[_ngcontent-%COMP%]{padding:0 0 1.7rem;text-align:center}.scanning[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{display:inline-block;position:relative;top:10px;left:15px;--color: #bacad4e0}.connecting[_ngcontent-%COMP%]{padding:20px 0;--color: #3a3939}.connecting[_ngcontent-%COMP%]   .selectedDevice[_ngcontent-%COMP%]{margin-bottom:2rem}.connecting[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{display:block;margin:10px auto 0;left:-5px;top:0}#keypad-pane[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:300;display:block}.test[_ngcontent-%COMP%]{position:absolute;top:24%;max-height:75%;width:100%;white-space:pre-wrap;overflow-y:scroll}@media only screen and (min-width: 380px){.content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:0}.content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.1rem;word-spacing:.3em}.content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.5em;right:.3em;top:-.35em}.connect[_ngcontent-%COMP%], .unlock[_ngcontent-%COMP%]{font-size:1.1rem}}@media only screen and (min-width: 480px){.content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:0}.content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.3rem;width:90%}.content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.7em;right:.6em;top:-.3em}.connect[_ngcontent-%COMP%], .unlock[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:600}ion-card-title[_ngcontent-%COMP%]{margin-top:2rem;font-size:1.4rem;font-weight:700}.scanning[_ngcontent-%COMP%]{padding:1.5rem 0 2.5rem;font-size:1.3rem}.scanning[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{top:.5rem;transform:scale(1.5)}.connecting[_ngcontent-%COMP%]   .selectedDevice[_ngcontent-%COMP%]{margin:1rem auto 2rem;font-size:1.3rem}.connecting[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{transform:scale(1.7);margin-top:5rem;margin-bottom:3rem}}@media only screen and (min-width: 720px){.content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:0}.content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.7rem;width:90%}.content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.7em;right:.6em;top:-.18em}}@media only screen and (min-height: 640px){ion-content[_ngcontent-%COMP%]{--notch-inset: 30px}}"]})}}return o})()}];let ne=(()=>{class o{static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[v.iI.forChild(te),v.iI]})}}return o})(),ie=(()=>{class o{static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[m.MD,P.YN,c.bv,ne]})}}return o})()}}]);